function cookiesInit(){;(function(factory){if(typeof define==='function'&&define.amd){define(factory)}else if(typeof exports==='object'){module.exports=factory()}else{var OldCookies=window.Cookies;var api=window.Cookies=factory();api.noConflict=function(){window.Cookies=OldCookies;return api}}}(function(){function extend(){var i=0;var result={};for(;i<arguments.length;i++){var attributes=arguments[i];for(var key in attributes){result[key]=attributes[key]}}
return result}
function init(converter){function api(key,value,attributes){var result;if(typeof document==='undefined'){return}
if(arguments.length>1){attributes=extend({path:'/'},api.defaults,attributes);if(typeof attributes.expires==='number'){var expires=new Date();expires.setMilliseconds(expires.getMilliseconds()+attributes.expires*864e+5);attributes.expires=expires}
try{result=JSON.stringify(value);if(/^[\{\[]/.test(result)){value=result}}catch(e){}
if(!converter.write){value=encodeURIComponent(String(value)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent)}else{value=converter.write(value,key)}
key=encodeURIComponent(String(key));key=key.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent);key=key.replace(/[\(\)]/g,escape);return(document.cookie=[key,'=',value,attributes.expires&&'; expires='+attributes.expires.toUTCString(),attributes.path&&'; path='+attributes.path,attributes.domain&&'; domain='+attributes.domain,attributes.secure?'; secure':''].join(''))}
if(!key){result={}}
var cookies=document.cookie?document.cookie.split('; '):[];var rdecode=/(%[0-9A-Z]{2})+/g;var i=0;for(;i<cookies.length;i++){var parts=cookies[i].split('=');var cookie=parts.slice(1).join('=');if(cookie.charAt(0)==='"'){cookie=cookie.slice(1,-1)}
try{var name=parts[0].replace(rdecode,decodeURIComponent);cookie=converter.read?converter.read(cookie,name):converter(cookie,name)||cookie.replace(rdecode,decodeURIComponent);if(this.json){try{cookie=JSON.parse(cookie)}catch(e){}}
if(key===name){result=cookie;break}
if(!key){result[name]=cookie}}catch(e){}}
return result}
api.set=api;api.get=function(key){return api(key)};api.getJSON=function(){return api.apply({json:!0},[].slice.call(arguments))};api.defaults={};api.remove=function(key,attributes){api(key,'',extend(attributes,{expires:-1}))};api.withConverter=init;return api}
return init(function(){})}))}
function reactricInit($){$("<link/>",{rel:"stylesheet",type:"text/css",href:"https://cdn.rawgit.com/reactric/reactric-plugin/master/css/style.min.css"}).appendTo("head");cookiesInit();var cleanString=function(input){var output="";for(var i=0;i<input.length;i++){if(input.charCodeAt(i)<=127){output+=input.charAt(i)}}
return output};var getProperURL=function(){return cleanString('http://www.'+window.location.hostname+window.location.pathname)};var addNecessaryElements=function(){$('div.reactric-reaction-panel').append("<div class=reactric-reaction-panel-content><table class='reactric-table reactric-table-top'><tr><td class=td-center>React!</td></tr></table><div class=reactric-options-collective><p class=reactric-loading>Loading...</div></p><div class=reactric-error-div></div><table class='reactric-table reactric-table-bottom'><tr><td class=td-left><a href=http://www.reactric.com/plugin/cookie-policy target=_blank class=reactric-link>Cookie Policy</a></td><td class=td-right><a href=http://www.reactric.com target=_blank class=reactric-powered-by-link><img src=http://res.cloudinary.com/dhhb1tde3/image/upload/c_scale,h_50/v1473257100/poweredbyreactric_qcw7tg.png></img></a></td></tr></table></div>")};var createAppendElement=function(name,type,count,image_url){return "<div data-reactric-name="+name+" data-reactric-type="+type+" class=reactric-reaction-option><p class=reactric-reaction-option-count data-reactric-count="+count+" data-reactric-backup-count="+count+">"+count+"</p><img src="+image_url+" class=reactric-reaction-option-img><p>"+name+"</p></div>"};var updateDataCount=function(name,count){for(var i=0;i<data.length;i++){if(data[i].name===name){data[i].count=count;break}}};var resp={},data=[],cookieName='reactric-cookie-'+$('div.reactric-reaction-panel').attr('data-reactric-website-key'),properURL=getProperURL(),cookie={},reactricApiUrl='http://127.0.0.1:8000/api/';var reactionPanel={init:function(url,websiteKey){$('div.reactric-reaction-panel-content').remove();addNecessaryElements();if(Cookies.getJSON(cookieName)===undefined){cookie[properURL]={count:0,name:'None',type:'None'};Cookies.set(cookieName,cookie,{expires:365})}else{cookie=Cookies.getJSON(cookieName)[properURL];if(cookie===undefined){cookie=Cookies.getJSON(cookieName);cookie[properURL]={count:0,name:'None',type:'None'};Cookies.set(cookieName,cookie,{expires:365})}}
cookie=Cookies.getJSON(cookieName)[properURL];$.ajax({url:reactricApiUrl+'content_detail_view/'+properURL,type:'GET',dataType:'json',success:function(json){$('p.reactric-loading').remove();resp=json;data=JSON.parse(json.data);for(var i=0;i<data.length;i++){$('div.reactric-options-collective').append(createAppendElement(data[i].name,data[i].reaction_type,data[i].count,data[i].image_url))};if(data.length>=5){$('img.reactric-reaction-option-img').animate({width:"45px"},100)}else if(data.length<=2){$('img.reactric-reaction-option-img').animate({width:"70px"},100)}
if(cookie.name!=='None'){$("div[data-reactric-name='"+cookie.name+"']").addClass('reactric-reaction-option-active').siblings().addClass('reactric-reaction-option-inactive')}
reactionPanel.initEvents(url)},error:function(req,status,err){if(req.status==404){$.ajax({url:reactricApiUrl+'website_detail/'+websiteKey+'/content_list/',type:'POST',dataType:'json',data:{"title":cleanString(document.title),"address":properURL},success:function(json){reactionPanel.init(url,websiteKey)},error:function(req,status,err){console.log(req+status+err);$('p.reactric-loading').remove();$('div.reactric-error-div').append('<p class=reactric-error-text>Something went wrong loading the panel.</p><p><button class=reactric-reload-button>Reload</button></p>');$('button.reactric-reload-button').click(function(){reactionPanel.init(url,websiteKey)})}})}
else{console.log(req+status+err);$('p.reactric-loading').remove();$('div.reactric-error-div').append('<p class=reactric-error-text>Something went wrong loading the panel.</p><p class=reactric-error-text><button class=reactric-reload-button>Reload</button></p>');$('button.reactric-reload-button').click(function(){reactionPanel.init(url,websiteKey)})}}})},initEvents:function(url){$('div.reactric-reaction-option').click(function(){var $this=$(this);$('div.reactric-error-div').empty();if(cookie.count>=300){alert("You can only change your reaction 3 times.");return}
$.ajax({url:url,type:'GET',dataType:'json',success:function(json){resp=json;data=JSON.parse(json.data);for(var i=0;i<data.length;i++){$("div[data-reactric-name='"+data[i].name+"']").children('p.reactric-reaction-option-count').attr('data-reactric-count',data[i].count)};reactionPanel.handleEvent(url,$this)},error:function(req,status,err){console.log(req+status+err);$('div.reactric-error-div').empty().append('<p class=reactric-error-text>Something went wrong. Try again.</p>')}})})},handleEvent:function(url,thisElem){var count,backupCount,$this=thisElem;if($this.hasClass('reactric-reaction-option-active')){count=parseInt($this.children('p.reactric-reaction-option-count').attr('data-reactric-count'))-1;backupCount=parseInt($this.children('p.reactric-reaction-option-count').attr('data-reactric-backup-count'))-1;updateDataCount($this.attr('data-reactric-name'),count)
$this.removeClass('reactric-reaction-option-active').children('p.reactric-reaction-option-count').attr('data-reactric-count',count).attr('data-reactric-backup-count',backupCount).text(backupCount).end().siblings().removeClass('reactric-reaction-option-inactive');if(cookie.type==='Positive'){resp.positive_reactions_count-=1}else if(cookie.type==='Negative'){resp.negative_reactions_count-=1}else{console.log('Possible Error (Can be ignored)')}
cookie.name='None';cookie.type='None'}else{if($this.hasClass('reactric-reaction-option-inactive')){var active=$('div.reactric-reaction-option-active');count=parseInt(active.children('p.reactric-reaction-option-count').attr('data-reactric-count'))-1;backupCount=parseInt(active.children('p.reactric-reaction-option-count').attr('data-reactric-backup-count'))-1;updateDataCount(active.attr('data-reactric-name'),count);active.children('p.reactric-reaction-option-count').attr('data-reactric-count',count).attr('data-reactric-backup-count',backupCount).text(backupCount)}
count=parseInt($this.children('p.reactric-reaction-option-count').attr('data-reactric-count'))+1;backupCount=parseInt($this.children('p.reactric-reaction-option-count').attr('data-reactric-backup-count'))+1;updateDataCount($this.attr('data-reactric-name'),count);$this.removeClass('reactric-reaction-option-inactive').addClass('reactric-reaction-option-active').children('p.reactric-reaction-option-count').attr('data-reactric-count',count).attr('data-reactric-backup-count',backupCount).text(backupCount).end().siblings().removeClass('reactric-reaction-option-active').addClass('reactric-reaction-option-inactive');if(cookie.type==='None'){if($this.attr('data-reactric-type')==='Positive'){resp.positive_reactions_count+=1}else if($this.attr('data-reactric-type')==='Negative'){resp.negative_reactions_count+=1}else{console.log('Possible Error (Can be ignored)')}}else{if(cookie.type==='Positive'&&$this.attr('data-reactric-type')==='Negative'){resp.positive_reactions_count-=1;resp.negative_reactions_count+=1}else if(cookie.type==='Negative'&&$this.attr('data-reactric-type')==='Positive'){resp.positive_reactions_count+=1;resp.negative_reactions_count-=1}else{console.log('No change.')}}
cookie.name=$this.attr('data-reactric-name');cookie.type=$this.attr('data-reactric-type');cookie.count+=1}
resp.data=JSON.stringify(data);$.ajax({url:url,type:'PUT',dataType:'json',data:resp,success:function(){var cookieContent=Cookies.getJSON(cookieName);cookieContent[properURL]=cookie;Cookies.set(cookieName,cookieContent,{expires:365});cookie=Cookies.getJSON(cookieName)[properURL]},error:function(req,status,err){console.log(req+status+err);$('div.reactric-error-div').empty().append('<p class=reactric-error-text>Something went wrong. Try again.</p>')}})}};reactionPanel.init(reactricApiUrl+'content_detail/'+properURL,$('div.reactric-reaction-panel').attr('data-reactric-website-key'))};function loadjQuery(url,success){var script=document.createElement('script');script.src=url;var head=document.getElementsByTagName('head')[0],done=!1;head.appendChild(script);script.onload=script.onreadystatechange=function(){if(!done&&(!this.readyState||this.readyState=='loaded'||this.readyState=='complete')){done=!0;success();script.onload=script.onreadystatechange=null;head.removeChild(script)}}};(function(){if(typeof jQuery=='undefined'){loadjQuery('https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js',function(){reactricInit(jQuery)})}else{reactricInit(jQuery)}})()
